# <center>多人对战版生命游戏

<center>
**团队成员**  <U>陈昕、李隆欣、危德健、周培衍</U>

 **日期**：&ensp;&ensp;&ensp; <U id="date"> 2016年10月14日</U>

**修订版本**&ensp;&ensp;<U>0.2</U>
</center>

###   <center>目录

[1.引言	](#1)

&ensp;&ensp;[1.1 编写目的](#1.1)

&ensp;&ensp;[1.2 风险分析](#1.2)

&ensp;&ensp;[1.3 文档约定](#1.3)

&ensp;&ensp;[1.4 预期读者和阅读建议](#1.4)

&ensp;&ensp;[1.5 参考文献](#1.5)

[2.综合描述](#2)

&ensp;&ensp;[2.1 产品状况](#2.1)

&ensp;&ensp;[2.2 产品功能](#2.2)

&ensp;&ensp;[2.3 运行环境](#2.3)

&ensp;&ensp;[2.4 设计和实现上的限制](#2.4)

&ensp;&ensp;[2.5 假设和约束(依赖)](#2.5)

[3.外部接口需求](#3)

&ensp;&ensp;[3.1 用户界面](#3.1)

&ensp;&ensp;[.2 硬件接口](#3.2)

&ensp;&ensp;[3.3 软件接口](#3.3)

&ensp;&ensp;[3.4 通讯接口](#3.4)

&ensp;&ensp;[3.4 通讯接口](#3.4)

&ensp;&ensp;[3.4 通讯接口](#3.4)

[4.系统功能需求](#4)

&ensp;&ensp;[4.1 说明和优先级](#4.1)

&ensp;&ensp;[4.2 激励／响应序列](#4.2)

&ensp;&ensp;[4.3 输入／输出数据](#4.3)

[5.其它非功能需求](#5)

&ensp;&ensp;[5.1 性能需求](#5.1)

&ensp;&ensp;[5.2 安全措施需求](#5.2)

&ensp;&ensp;[5.3 安全性需求](#5.3)

&ensp;&ensp;[5.4 软件质量属性](#5.4)

&ensp;&ensp;[5.5 业务规则](#5.5)

&ensp;&ensp;[5.6 业务规则](#5.6)

[6.词汇表](#6)

[7.数据定义](#7)

[8.分析模型](#8)

[9.待定问题列表](#9)






## <a id="1"> 1.引言</a>

该文档是多人对战版生命游戏的需求分析说明，按照该产品所需要实现的外部接口需求、系统功能需求、安全性需求、性能需求等方面来进行组织。

## <a id="1.1">1.1 编写目的</a>

该软件产品需求分析报告，是为了多人对战版生命游戏而编写的。

传统上，生命游戏是一个零玩家游戏，用户只能看到根据系统生成的初始生命不断地有生命诞生和死亡的过程，不具备交互性，娱乐性不高。

本软件在传统生命游戏的规则上加入交互性，用户可以通过浏览器登录网站，和他人进行对战，提高了趣味性，又由于生命游戏是有规律可循的，所以也有一定的技巧性。这些使得该软件成为休闲娱乐时的一个不错的选择。

编写此文档可以帮助用户更加了解该产品的各方面信息，通过这份软件产品需求分析报告详尽说明了该软件产品的需求规格，包括修正和(或)发行版本号，从而对该软件产品进行准确的定义。

## <a id="1.2">1.2 风险分析</a>

法律风险分析：

生命游戏本身是开放的，并没有版权所有者，任何人都可以开发自己的版本。本软件使用到的第三方库都是开放的，根据用户协议可以使用在本软件上。

技术风险分析：

本软件为B/S架构，最终运行在用户的浏览器上，前端使用html5+css3+javascipt，后台使用python开发语言。这种模式已经被非常多的网站验证过了，事实证明是有效、可靠的。前端负责显示而后台负责数据的处理，中间使用标准的HTTP协议通信，减少了设计上的压力。

前端使用html5，减少了对flash这种第三方软件的依赖，可以运行在所有现代的浏览器上，完全跨平台，不需要开发多个版本。而后台使用的python+django也是非常成熟的，具有稳定和高效的特性，完全可以支撑大量用户的访问。

Mysql数据库也被反复验证过了，符合本软件的使用场景。

## <a id="1.3">1.3 文档约定</a>

描述编写文档时所采用的标准为：

正文风格：宋体小四，1.5倍行距

提示方式：黑色加粗字

重要符号：·

**每次进行修改必须修改版本号，并在目录上更新域。**

## <a id="1.4">1.4 预期读者和阅读建议</a>

本软件产品需求分析报告可能的预期读者有：

文档编写人员、开发人员、测试人员、监督人员（老师/助教）。

针对每一种人群的阅读建议如下：

文档编写人员：全文详细阅读。

开发人员：外部接口需求、系统功能需求、其他非功能性需求、词汇表、数据定义。

测试人员：综合描述、其他非功能性需求、词汇表、数据定义。

监督人员：全文阅读。

## <a id="1.5">1.5 参考文献</a>

[康夫生命游戏](https://zh.wikipedia.org/wiki/%E5%BA%B7%E5%A8%81%E7%94%9F%E5%91%BD%E6%B8%B8%E6%88%8F)

[Python 3教程](http://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000)

[w3school 在线教程](http://www.w3school.com.cn/)

[敏捷开发之Scrum扫盲篇](http://www.cnblogs.com/taven/archive/2010/10/17/1853386.html)

[Adminlte](https://almsaeedstudio.com/) [(前端模板)](https://almsaeedstudio.com/)

[e](http://echarts.baidu.com/) [charts](http://echarts.baidu.com/) [(游戏棋盘)](http://echarts.baidu.com/)

[基于Django和Python的Web开发](http://wenku.baidu.com/link?url=I7N0sEcFDnc0FWwmHTgjjAEYI_TqG7Io7L6uWkcEsZKVsFgX5gzXbmt4YfuFtmeh9c5EmDzy1Coj2r8Yamc7W3dpnru1n-glv5ggXjHA6ca)

[Python Django Web开发入门](http://edu.csdn.net/course/detail/2337)

[RFC\_6265标准文档](http://wenku.baidu.com/link?url=tnJRP8PzSjQOsQp0e8xyl6Zac4i_YP7_oNYfp-r1c-zBSkZJtSVhCZMRTZ7AzGqfg0DOmBEtcuEeAIlCVeK9bVRbSPmPc2W_HwNqYfHF5ce)

[Python编码规范](http://www.runoob.com/w3cnote/google-python-styleguide.html)

[javascript编码规范](http://www.jb51.net/article/87142.htm)

《多人对战生命游戏规则》

## <a id="2">2.综合描述</a>

多人对战版生命游戏前端使用html5+css3+javascipt，后台使用python。它运行于在浏览器中，只要用户登录就会提示输入昵称并自动分配一个编号，然后就可以进行游戏。游戏是回合制的，游戏规则则对原始规则进行了一点修改，详见下方&#39;产品功能&#39;部分。由于没有对用户使用数据库存储，而是直接用浏览器的cookie保存历史信息，所以没办法保证数据持久性。软件的用户、限制等信息详见&#39;设计和实现上的限制&#39;、&#39;假设和约束&#39;部分。

## <a id="2">2.1 产品状况</a>

生命游戏是英国数学家约翰·何顿·康威在1970年发明的细胞自动机。它最初于1970年10月在《科学美国人》杂志中马丁·葛登能（Martin Gardner，1914年11月21日－2010年5月22日。又译：马丁·加德纳）的&quot;数学游戏&quot;专栏出现。

本软件定位为一个休闲益智游戏，使用时不需要进行注册，直接进入并填上昵称就能开始，减少了用户进行游戏的负担。

我们对生命游戏的原始规则做出了修订，添加了多人对战的规则，增加了趣味性和对抗性，使游戏性变得更强了。它作为一个益智游戏，有着非常明确的获胜规则，可以供用户在无聊时小小地玩上一局，享受胜利的感觉；又有合适的房间机制，让用户可以很方便的和朋友共同游戏。

## <a id="2.2">2.2 产品功能</a>

 ![](http://ofoq3ktia.bkt.clouddn.com/lifegame%E6%B8%B8%E6%88%8F%E6%B5%81%E7%A8%8B.png) 

用户使用本软件时的大体流程如上图所示。以下将用户称为玩家。

每个房间可以在有2-4个玩家的情况下进行游戏，系统为每个玩家分配不同的颜色来表示不同玩家所拥有的生命。采用回合制，在轮到自己的回合时玩家能向棋盘上添加自己队伍的生命，限时5秒，最多可以添加5个生命。每一轮游戏为180分钟，最后留下的生命最多的玩家为胜者。

产品功能的详细定义见第4章。

## <a id="2.3">2.3 运行环境</a>

本软件并不依赖特定的硬件平台与操作系统，只要使用浏览器就能进行访问。推荐使用PC而不是移动设备访问本软件。

推荐使用的浏览器：chrome, firefox, safari, ie 8及以上。

服务器操作系统：不限

数据库：mysql 5.7

## <a id="2.4">2.4 设计和实现上的限制</a>

本软件确定使用的工具如下：

前端：html5+css3+javascript(ECMAScript 6)

后台：Python 3.5

前端与后台交换数据统一采用json格式，后台经过处理后，使用二维数组进行游戏场地上生命的下一次存活状态的计算。

**编码规范见《多人对战版生命游戏代码规范》。**

其他工具：

团队协作：github、leangoo

版本管理：git

单元测试：pyunit

性能分析：profile（python自带）

代码风格检查：pylint。

## <a id="2.5">2.5 假设和约束(依赖)</a>

我们计划使用的第三方库如下：

前端框架：Bootstrap v3.3.0

前端模板：AdminLTE v2.3.6

前端图表：ECharts v3.2.3

Python开发框架：django 1.10.1

工期：5-17周

人员（按姓名拼音首字母排序）：陈昕、李隆欣、危德健、周培衍

任务分配和要完成的任务如下图所示：

 ![]( http://ofoq3ktia.bkt.clouddn.com/lifegame%E4%BB%BB%E5%8A%A1%E5%88%86%E9%85%8D.png) 

## <a id="3">3.外部接口需求</a>

## <a id="3.1">3.1 用户界面</a>

尽量采用简单直观的界面，便于用户尽快上手，开始玩游戏。

用户进入网站时，采用简单的对话框提示用户输入昵称。

采用表格的方式显示房间，优先显示目前可加入的房间。房间是分页显示的，每页显示20个。用户可以根据房间名进行搜索，还有&#39;创建房间&#39;和&#39;随机匹配&#39;两个加入房间的方法。

在游戏界面里，有准备和开始两种状态。开始游戏后，中间显示游戏场地，四个角落显示用户信息，用不同的颜色代表不同用户。用户在自己的回合可以通过在场地上点击添加自己队伍的生命。用户随时可以点击按钮退出房间。

时间显示的格式统一为：yyyy-MM-dd HH:mm:ss (24小时制)

采用GMT+8:00（北京时间）作为显示时间所用的标准时区。

##  <a id="3.2">3.2 硬件接口</a>

完全跨平台，无特定硬件需求。

由于移动端可能显示效果不佳，所以推荐使用PC机进行访问。

##  <a id="3.3">3.3 软件接口</a>

服务器使用CentOS6.5，采用mysql5.7数据库，其他第三方工具见2.5 假设和约束。

## <a id="3.4">3.4 通讯接口</a>

主要通过HTTP协议进行数据在用户浏览器和服务器之间的传输，采用RFC6265标准在用户机器上存储数据，记录上次的用户数据。统一采用json格式进行数据的相互发送。

## <a id="4">4.系统功能需求</a>

## <a id="4.1">4.1 说明和优先级</a>

1). 填写昵称：在用户第一次登录时，弹窗提示可以填写昵称。如果不填写而选择取消，则显示匿名。系统会给用户自动分配id，唯一地标识一个用户。如果不是第一次登录，浏览器中应该存在cookie，则从中读取用户昵称等信息。这个功能是用户登录时第一次会见到的界面，要符合软件整体风格；但是这个窗口并不会总是呈现在用户面前，所以优先级为低。

2). 房间选择：两个主界面之一，用户通过这个界面来寻找自己要进入的游戏房间。一个房间可以有2-4个人。这个界面上需要用合适的方式将房间的信息（房间号码、名称、房主、人数、当前状态）呈现给用户，可以考虑列表或表格，使页面上能显示20个房间信息。如果当前有多于20个房间，通过自动分页让一页至多显示20个房间。优先显示目前没有在进行游戏且没有满员的房间。点击房间可以：(1)直接进入房间；(2)显示无法进入房间的原因。由于经常使用，本功能优先级为高。

![](http://ofoq3ktia.bkt.clouddn.com/lifegame%E5%BC%80%E5%A7%8B%E7%95%8C%E9%9D%A2.png)

3). 创建房间：这个功能表现为房间选择页面上的一个按钮，创建房间的人即进入房间并成为房主。房主要等待有人加入并准备后才能开始游戏，至少需要一个其他用户的加入。本功能为附属功能，优先级为中。

4). 随机匹配：这个功能表现为房间选择界面上的一个按钮，随机选择一个既没有满员也不是正在游戏的房间，让点击按钮的用户加入。本功能为附属功能，而且并非无法替代，所以优先级为低。

5). 房间界面：两个主界面之一，用户进入房间后在这个界面上选择准备（如果是房主，选择开始）。页面四个角落显示本房间中的用户信息，包括昵称、在本房间的编号、代表色、当前积分、胜率等。左上、右下、右上、左下分别为1,2,3,4号位置，默认按加入房间的先后顺序排列用户，如果有用户退出房间，那么他的位置会被空出；如果退出房间的是房主，那么选择一个还在房间里的用户成为房主；如果所有用户全部退出了房间，那么房间将被删除。页面中间显示游戏场地，为20×20的正方形，每个生命能占一个格子，颜色为它属于的用户的代表色。这个功能优先级为高。

![](http://ofoq3ktia.bkt.clouddn.com/lifegame%E6%B8%B8%E6%88%8F%E7%95%8C%E9%9D%A2.png)

6). 游戏进行：在房间成员全部准备好，房主点击开始后，游戏开始进行。一局游戏为180秒，最后剩下生命最多的玩家获胜，如果有多个玩家剩下的积分相同，则他们都是胜者；剩下的生命数会被累加到玩家的积分上。首先，在场地上为每个用户分配自己队伍的25个生命。接下来按照回合制，从房主开始，每个用户有权利在5秒内向场地添加最多10个自己队伍的生命，接下来后台会根据场地当前情况计算生命的生死状态，并显示到前端。生命生死状态计算的具体规则参照《多人对战生命游戏规则》。用户的时间主要就花在这个功能上，优先级为超高。

7). 开始（房主）/准备（非房主）：本功能表现为房间界面上的按钮。在用户进入房间后，需要用准备确认自己能进行比赛。在所有用户都准备之后，房主可以选择开始游戏。准备和开始的时间（从所有用户准备好后开始记）都不能超过15秒，否则会被强制退出房间。本功能优先级为中。

8). 离开房间：本功能表现为房间界面上的按钮。只有在等待时才能退出房间，在进行游戏时是不能退出的。如果用户关闭浏览器，他的角色依旧会默认留在房间里进行游戏，在游戏结束后会因为不准备而被强制退出。如果用户是意外关闭浏览器，之后又打开了界面，则回到房间进行继续进行游戏。本功能优先级为中。

## <a id="4.2">4.2 激励／响应序列</a>

首先，用户会进入页面。这个时候，会有两种可能的情况：

1)  如果在浏览器上没有找到用户上次登录的信息（即第一次登录），那么会弹窗提示用户输入昵称。如果用户输入昵称，那么用户的昵称设置为输入的昵称；如果用户点击取消或关闭弹窗，那么用户昵称会被设置为匿名。系统会根据当前时间自动分配用户编号。

2) 如果在浏览器上找到了上次登录的信息，那么从中读取出用户的编号、昵称、积分、胜率等信息。

接下来，用户会选择房间进行游戏。这时，有三种方式：

1) 点击房间信息，直接进入所选的房间。在房间满员或正在进行游戏的情况下，无法进入，会弹出相应的错误提示。

2) 进行随机匹配，系统自动找到一个可以加入的房间并让用户进入。在所有房间都满员或正在进行游戏的情况下，提示用户找不到合适的房间，可以选择自己创建房间。

3) 创建房间，系统上会记载一个新房间被创建了，并自动分配一个房间号。创建房间时能够设置房间名，创建者默认被放到1号位上。

如果用户在本页面上关闭浏览器，不会对系统造成什么影响。

然后，非房主用户在房间要点击准备按钮，在所有用户都准备后，房主能够点击开始，然后就可以正式进行游戏了。如果用户在进入房间后15秒内不准备，会被踢出房间；如果在所有用户准备后房主不在15秒内点击开始，那么房主会被踢出房间，选择一个目前在房间里的用户成为房主，重新开始计算15秒的开始时间。用户也可以选择退出房间，重新进入到房间选择界面。

如果用户在这个时候关闭浏览器，情况要视用户是否准备而定。如果用户没有进行准备（或者用户作为房主一直不开始游戏），那么会被踢出房间。如果用户已经准备了，那么用户也会进入游戏。当用户在这种情况下重新打开浏览器进入到页面，那么系统会直接让他进入游戏界面；如果用户不进行操作，系统还是会给他分配回合，但由于无人操作，所以会简单地等待5秒并进入下一个用户的回合。

在游戏开始后，用户只能在自己的回合内选择在游戏场地的空格子内添加属于自己队伍的生命，如果在此时退出房间，则参考上一段的处理。

## <a id="4.3">4.3 输入／输出数据</a>

输入数据：

| 数据名称 | 实际含义 | 数据类型 | 数据格式 | 数据约束 |
| --- | --- | --- | --- | --- |
| 用户昵称 | 用户在本软件中进行游戏时所使用的昵称 | 字符串 | JSON | 不能为空 |
| 进入房间 | 某个用户发出的进入某个房间的请求，包括用户编号和房间编号 | 字典 | JSON | 用户编号和房间编号不为空 |
| 创建房间 | 某个用户发出的创建一个新房间的请求，包括用户编号 | 整型 | JSON | 用户编号不为空 |
| 随机匹配 | 某个用户发出的随机进入某个房间的请求，包括用户编号 | 整型 | JSON | 用户编号不为空 |
| 准备/开始 | 某个房间中的某个用户要进行准备或开始游戏，包括用户编号和他所在的房间 | 字典 | JSON | 用户编号和房间编号不为空 |
| 退出房间 | 某个房间中的某个用户要退出房间，包括用户编号和他所在的房间 | 字典 | JSON | 用户编号和房间编号不为空 |
| 游戏场地 | 某个房间的游戏场地情况，在用户的回合结束时会整个发给后台，包括用二维数组表示的游戏场地情况和房间编号 | 字典 | JSON | 房间编号不为空 |

输出数据：

| 数据名称 | 实际含义 | 数据类型 | 数据格式 | 数据约束 |
| --- | --- | --- | --- | --- |
| 用户信息 | 用户的所有信息，除了不展现给用户的编号，还包括用户昵称、积分、胜率 | 字典 | JSON | 不能为空 |
| 房间信息 | 房间号码、名称、房主、人数、当前状态（是否正在进行游戏） | 字典 | JSON | 不能为空 |
| 游戏场地 | 某个房间的游戏场地情况，在后台计算完毕后向前端发送，包括用二维数组表示的游戏场地情况和房间编号 | 字典 | JSON | 房间编号不为空 |


##  <a id="5">5.其它非功能需求</a>

##  <a id="5.1">5.1 性能需求</a>

##  <a id="5.2">5.2 安全措施需求</a>

##  <a id="5.3">5.3 安全性需求</a>

##  <a id="5.4">5.4 软件质量属性</a>

##  <a id="5.5">5.5 业务规则</a>

##  <a id="5.6">5.6 业务规则</a>

## <a id="6">6.词汇表</a>
## <a id="7">7.数据定义</a>
## <a id="8">8.分析模型</a>
## <a id="9">9.待定问题列表</a>
