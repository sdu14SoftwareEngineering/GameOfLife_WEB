<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap 101 Template</title>

    <script src="/static/js/echarts.js"></script>
    <!-- Bootstrap -->
    <link href="/static/css/bootstrap.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="http://cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="/static/js/jquery.min.js"></script>
</head>
<body>
<div class="container">
    <div class="row">
        <p>
            <center>
                <button id="bt_userready" class="btn btn-large btn-primary" type="button">准备</button>
                <button id="bt_userexit" class="btn btn-large" type="button">退出</button>
                <p id="userid_hidden" hidden="hidden">1</p>
                <p id="roomid_hidden" hidden="hidden">1</p>
            </center>
        </p>
    </div>
    <div class="row">
        <div class="col-md-2">
            <div style="height:30px;"></div>
            <div class="panel panel-primary">
                <div class="panel-heading">
                    <h3 class="panel-title">昵称:</h3>
                </div>
                <div class="panel-body">
                    <p>编号:{{user_a}}</p>
                    <p>积分:</p>
                    <p>胜率:</p>
                </div>
            </div>

            <div style="height:200px;"></div>
            <div class="panel panel-success">
                <div class="panel-heading">
                    <h3 class="panel-title">昵称:</h3>
                </div>
                <div class="panel-body">
                    <p>编号:</p>
                    <p>积分:</p>
                    <p>胜率:</p>
                </div>
            </div>
        </div>
        <div class="col-md-8">
            <div id="gamezone" style="width: 100%;height:600px;">
            </div>
        </div>
        <div class="col-md-2">
            <div style="height:30px;"></div>
            <div class="panel panel-warning">
                <div class="panel-heading">
                    <h3 class="panel-title">昵称:</h3>
                </div>
                <div class="panel-body">
                    <p>编号:</p>
                    <p>积分:</p>
                    <p>胜率:</p>
                </div>
            </div>
            <div style="height:200px;"></div>
            <div class="panel panel-danger">
                <div class="panel-heading">
                    <h3 class="panel-title">昵称:</h3>
                </div>
                <div class="panel-body">
                    <p>编号:</p>
                    <p>积分:</p>
                    <p>胜率:</p>
                </div>
            </div>
        </div>
    </div>
    <div class="row">...</div>
</div>

<script type="text/javascript">
    // 基于准备好的dom，初始化echarts实例
    var myChart = echarts.init(document.getElementById('gamezone'));

    var dataAll = [
        [
            [0.5, 0.5],
            [8.5, 6.5],
            [13.5, 7.5],
            [9.5, 8.5],
            [11.5, 8.5],
            [14.5, 9.5],
            [6.5, 7.5],
            [4.5, 4.5],
            [12.5, 10.5],
            [7.5, 4.5],
            [5.5, 5.5]
        ],
        [
            [1.5, 1.5],
            [9.5, 7.5],
            [14.5, 8.5],
            [10.5, 9.5],
            [12.5, 9.5],
            [15.5, 10.5],
            [7.5, 8.5],
            [5.5, 5.5],
            [13.5, 11.5],
            [8.5, 5.5],
            [6.5, 6.5]
        ],
        [
            [2.5, 2.5],
            [10.5, 8.5],
            [15.5, 8.5],
            [10.5, 10.5]
        ],
        [
            [3.5, 2.5],
            [17.5, 8.5],
            [16.5, 8.5],
            [12.5, 10.5]
        ]
    ];

    option = {
        title: {
            text: '生命游戏',
            x: 'center',
            y: 0
        },
        grid: [
            {x: '7%', y: '7%', width: '80%', height: '80%'}
        ],
        tooltip: {
            formatter: 'Group {a}: ({c})'
        },
        xAxis: [
            {gridIndex: 0, min: 0, max: 20, interval: 1}
        ],
        yAxis: [
            {gridIndex: 0, min: 0, max: 20, interval: 1}
        ],
        series: [
            {
                name: '1',
                type: 'scatter',
                xAxisIndex: 0,
                yAxisIndex: 0,
                data: dataAll[0],
                symbol:'rect',
                symbolSize:20,
                itemStyle: {
                    normal: {
                        // shadowBlur: 10,
                        // shadowColor: 'rgba(128, 128, 128, 1)',
                        // shadowOffsetY: 5,
                        color: 'rgb(66, 139, 202)'
                    }
                }
            },
            {
                name: '2',
                type: 'scatter',
                xAxisIndex: 0,
                yAxisIndex: 0,
                data: dataAll[1],
                symbol:'rect',
                symbolSize:20,
                itemStyle: {
                    normal: {
                        // shadowBlur: 10,
                        // shadowColor: 'rgba(128, 128, 128, 1)',
                        // shadowOffsetY: 5,
                        color: 'rgb(184, 212, 135)'
                    }
                }
            },
            {
                name: '3',
                type: 'scatter',
                xAxisIndex: 0,
                yAxisIndex: 0,
                data: dataAll[2],
                symbol:'rect',
                symbolSize:20,
                itemStyle: {
                    normal: {
                        // shadowBlur: 10,
                        // shadowColor: 'rgba(128, 128, 128, 1)',
                        // shadowOffsetY: 5,
                        color: 'rgb(249, 235, 113)'
                    }
                }
            },
            {
                name: '4',
                type: 'scatter',
                xAxisIndex: 0,
                yAxisIndex: 0,
                data: dataAll[3],
                symbol:'rect',
                symbolSize:20,
                itemStyle: {
                    normal: {
                        // shadowBlur: 10,
                        // shadowColor: 'rgba(128, 128, 128, 1)',
                        // shadowOffsetY: 5,
                        color: 'rgb(236, 131, 148)'
                    }
                }
            }
        ]
    };
    // 使用刚指定的配置项和数据显示图表。
    myChart.setOption(option);
</script>

<script type="text/javascript">
    var timedCount = function(){
        // 发出AJAX请求

        setTimeout(timedCount,1000);
    }

    $(document).ready(function(){
        timedCount();

        var ready = true;
        $("#bt_userready").click(function(){
            console.log('userready');
            var url;
            if(ready) url = '/user_ready';
            else url = '/user_cancel_ready';

            $.ajax({
                type:'post',
                url:url,
                dataType: 'json',
                data: {
                    user_id: $("#userid_hidden").text(),
                    room_id: $("#roomid_hidden").text()
                },
                success: function(data){
                    console.log(data);
                    ready = !ready;
                    if(ready) $("#bt_userready").text("准备");
                    else $("#bt_userready").text("取消准备");
//                    $("#bt_userready").prop("disabled", true);

                },
                error: function(jqXHR, textStatus, errorThrown){
//                    alert('error ' + textStatus + " " + errorThrown);
                }
            });
        });

        $("#userexit").click(function(){
            console.log('userexit');
            $.ajax({
                type:'post',
                url:"/exit_room_by_id",
                dataType: 'json',
                data: {
                    user_id: $("#userid_hidden").text(),
                    room_id: $("#roomid_hidden").text()
                },
                success: function(data){
                    console.log(data);
                },
                error: function(jqXHR, textStatus, errorThrown){
//                    alert('error ' + textStatus + " " + errorThrown);
                }
            });
        });
    });
</script>

<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="http://cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="/static/js/bootstrap.min.js"></script>
</body>
</html>
